### ğŸ” **å½“å‰çŠ¶æ€è¯´æ˜**

1. **ç¯å¢ƒé…ç½®å®Œæˆ**

   - ç¯å¢ƒåç§°ï¼š`my_ai`

   - å®‰è£…è·¯å¾„ï¼š`F:\ChuangYe\Anaconda3\envs\my_ai`

   - Python ç‰ˆæœ¬ï¼š

     ```bash
     3.10.18
     ```

     ï¼ˆè‡ªåŠ¨åŒ¹é… 3.10 çš„æœ€æ–°ç¨³å®šç‰ˆï¼‰

   - ä¾èµ–åŒ…ï¼šå…± 16 ä¸ªåŸºç¡€åŒ…ï¼ˆå¦‚ `pip`, `setuptools`, `sqlite` ç­‰ï¼‰

   åœ¨CMDä¸­è¿è¡Œï¼š

   ```bash
   #åœ¨è¿è¡Œactivateä¹‹å‰è¦å…ˆåˆå§‹åŒ– Conda 
   <C:\Windows\System32> conda activate my_ai
   #åˆå§‹åŒ–ä»£ç  åˆå§‹åŒ–Conda 
   <C:\Windows\System32> conda init cmd.exe
   #å¯èƒ½çš„è¾“å‡º ï¼ˆçœ‹ä¸€çœ‹å°±è¡Œï¼‰ 
   no change     F:\ChuangYe\Anaconda3\Scripts\conda.exe
   no change     F:\ChuangYe\Anaconda3\Scripts\conda-env.exe
   no change     F:\ChuangYe\Anaconda3\Scripts\conda-script.py
   no change     F:\ChuangYe\Anaconda3\Scripts\conda-env-script.py
   no change     F:\ChuangYe\Anaconda3\condabin\conda.bat
   no change     F:\ChuangYe\Anaconda3\Library\bin\conda.bat
   no change     F:\ChuangYe\Anaconda3\condabin\_conda_activate.bat
   no change     F:\ChuangYe\Anaconda3\condabin\rename_tmp.bat
   no change     F:\ChuangYe\Anaconda3\condabin\conda_auto_activate.bat
   no change     F:\ChuangYe\Anaconda3\condabin\conda_hook.bat
   no change     F:\ChuangYe\Anaconda3\Scripts\activate.bat
   no change     F:\ChuangYe\Anaconda3\condabin\activate.bat
   no change     F:\ChuangYe\Anaconda3\condabin\deactivate.bat
   no change     F:\ChuangYe\Anaconda3\Scripts\activate
   no change     F:\ChuangYe\Anaconda3\Scripts\deactivate
   no change     F:\ChuangYe\Anaconda3\etc\profile.d\conda.sh
   no change     F:\ChuangYe\Anaconda3\etc\fish\conf.d\conda.fish
   no change     F:\ChuangYe\Anaconda3\shell\condabin\Conda.psm1
   no change     F:\ChuangYe\Anaconda3\shell\condabin\conda-hook.ps1
   no change     F:\ChuangYe\Anaconda3\Lib\site-packages\xontrib\conda.xsh
   no change     F:\ChuangYe\Anaconda3\etc\profile.d\conda.csh
   modified      HKEY_CURRENT_USER\Software\Microsoft\Command Processor\AutoRun
   ```

ğŸ” **è¾“å‡ºç»“æœè§£æ**

1.**`no change` çš„å«ä¹‰**

- è¡¨ç¤º Conda é…ç½®æ–‡ä»¶ï¼ˆå¦‚è„šæœ¬ã€ç¯å¢ƒå˜é‡ï¼‰å·²æ­£ç¡®è®¾ç½®ä¸”æ— éœ€æ›´æ–°ï¼Œè¯´æ˜ä½ çš„ Conda åŸºç¡€é…ç½®æ­¤å‰å·²å®Œæˆã€‚

- è¿™äº›æ–‡ä»¶åŒ…æ‹¬æ ¸å¿ƒè„šæœ¬ï¼ˆ`conda.exe`ã€`activate.bat`ï¼‰ã€Shell æ”¯æŒè„šæœ¬ï¼ˆ`conda.sh`ã€`conda.ps1`ï¼‰ç­‰ï¼Œè¦†ç›– 

  CMDã€PowerShellã€Git Bash ç­‰ç»ˆç«¯ç¯å¢ƒã€‚

2.**å”¯ä¸€ä¿®æ”¹é¡¹ï¼šæ³¨å†Œè¡¨é”®å€¼**

```bash
modified HKEY_CURRENT_USER\Software\Microsoft\Command Processor\AutoRun
```

- **ä½œç”¨**ï¼šæ­¤ä¿®æ”¹ä½¿ CMD åœ¨æ¯æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ Conda ç¯å¢ƒï¼ˆå¦‚è‡ªåŠ¨æ¿€æ´»baseç¯å¢ƒï¼‰ã€‚
- **å½±å“**ï¼šæ— éœ€æ‰‹åŠ¨è¿è¡Œ `conda activate base`ï¼Œå‘½ä»¤è¡Œæç¤ºç¬¦ä¼šæ˜¾ç¤º `(base)` å‰ç¼€ã€‚

> **å®Œæˆä»¥ä¸Šæ“ä½œé€€å‡ºå½“å‰CMD,é‡æ–°ä»¥ç®¡ç†å‘˜å¯åŠ¨,é‡æ–°æ‰§è¡ŒConda activate my_ai** 

### âš™ï¸ **å½“å‰çŠ¶æ€è§£æ**

1. **ç¯å¢ƒæ¿€æ´»æˆåŠŸ**
   - å‰ç¼€ (my_ai) ç¡®è®¤ Conda ç¯å¢ƒmy_aiå·²æ¿€æ´»ã€‚
   - å½“å‰è·¯å¾„ `C:\Windows\System32` æ˜¯æ‰§è¡Œå‘½ä»¤æ—¶çš„é»˜è®¤ä½ç½®ï¼ˆé Conda æ§åˆ¶è¡Œä¸ºï¼‰ã€‚
2. **æ½œåœ¨é£é™©**
   - **ç³»ç»Ÿç›®å½•æ“ä½œå±é™©**ï¼šåœ¨ `System32` ä¸‹è¿è¡Œé¡¹ç›®æˆ–å®‰è£…åŒ…å¯èƒ½è§¦å‘æƒé™é”™è¯¯æˆ–æ„å¤–ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶ã€‚
   - **è·¯å¾„æ··æ·†**ï¼šç¯å¢ƒæ¿€æ´»åå·¥ä½œç›®å½•æœªè‡ªåŠ¨åˆ‡æ¢åˆ°é¡¹ç›®è·¯å¾„ï¼Œéœ€æ‰‹åŠ¨è°ƒæ•´ã€‚

### ğŸ› ï¸ **ä¸‹ä¸€æ­¥æ“ä½œæŒ‡å—**

#### âœ… 1. **åˆ‡æ¢è‡³å®‰å…¨å·¥ä½œç›®å½•**

```bash
# é€€å‡ºç³»ç»Ÿç›®å½•ï¼Œåˆ‡æ¢åˆ°ç”¨æˆ·ç›®å½•ï¼ˆæ¨èï¼‰
cd %USERPROFILE%  
# æˆ–ç›´æ¥è¿›å…¥é¡¹ç›®è·¯å¾„
cd F:\YourProject
```

**ä½œç”¨**ï¼šé¿å…è¯¯æ“ä½œç³»ç»Ÿæ–‡ä»¶ï¼Œéš”ç¦»é¡¹ç›®ä»£ç ä¸ç¯å¢ƒä¾èµ–ã€‚

### å®‰è£…æ ¸å¿ƒåº“

```bash
pip install torch==2.3.0 torchvision==0.18.0 --index-url https://download.pytorch.org/whl/cpu  # CPUç‰ˆæœ¬
# GPUç”¨æˆ·æ›¿æ¢ä¸ºï¼špip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

### âš ï¸ **æ³¨æ„äº‹é¡¹**

1. CPU ä¸ GPU ç‰ˆæœ¬çš„åŒºåˆ«

   - CPU ç‰ˆï¼šç‰¹åˆ«æ ‡æ³¨äº†"CPUç‰ˆæœ¬"ï¼Œè¡¨æ˜å¯èƒ½æ²¡æœ‰NVIDIA GPUï¼Œæˆ–è€…æš‚æ—¶ä¸éœ€è¦GPUåŠ é€ŸåŠŸèƒ½ï¼Œä»…ä½¿ç”¨ CPU è¿›è¡Œè®¡ç®—ï¼Œé€‚åˆæ—  NVIDIA æ˜¾å¡æˆ–éœ€è½»é‡éƒ¨ç½²çš„åœºæ™¯ã€‚
   - GPU ç‰ˆï¼šéœ€é¢å¤–æŒ‡å®š CUDA ç‰ˆæœ¬ï¼ˆå¦‚--index-url https://download.pytorch.org/whl/cu121ï¼‰ï¼Œå¹¶ä¾èµ– NVIDIA é©±åŠ¨å’Œ CUDA å·¥å…·åŒ…ã€‚

2. ç‰ˆæœ¬å…¼å®¹æ€§

   - torchä¸torchvisionç‰ˆæœ¬éœ€ä¸¥æ ¼åŒ¹é…ï¼ˆå¦‚torch 2.3.0å¯¹åº”torchvision 0.18.0ï¼‰ï¼Œå¦åˆ™å¯èƒ½æŠ¥é”™ã€‚

3. å®‰è£…é€Ÿåº¦ä¼˜åŒ–

   - è‹¥ä¸‹è½½ç¼“æ…¢ï¼Œå¯æ”¹ç”¨å›½å†…é•œåƒæºï¼ˆå¦‚æ¸…åæºï¼‰ï¼š

     ```bash
     pip install torch==2.3.0 torchvision==0.18.0 -i https://pypi.tuna.tsinghua.edu.cn/simple
     ```

     ä½†éœ€æ³¨æ„ï¼š**é•œåƒæºå¯èƒ½ç¼ºå°‘ç‰¹å®šç‰ˆæœ¬**ï¼Œéœ€ä¼˜å…ˆæ£€æŸ¥å¯ç”¨æ€§ã€‚

### âš™ï¸ **GPU ç‰ˆ PyTorch å®‰è£…å‘½ä»¤è§£æ**

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

- æ ¸å¿ƒä½œç”¨ï¼šå®‰è£…æ”¯æŒ CUDA 12.1çš„ PyTorch GPU ç‰ˆæœ¬ã€‚
- ç»„ä»¶è¯´æ˜ï¼š
  - `torch`: PyTorch æ ¸å¿ƒåº“ï¼ˆçº¦ 1GBï¼‰
  - `torchvision`: è®¡ç®—æœºè§†è§‰æ‰©å±•åº“ï¼ˆçº¦ 2MBï¼‰
  - `torchaudio`: éŸ³é¢‘å¤„ç†æ‰©å±•åº“ï¼ˆçº¦ 2MBï¼‰
- ç‰ˆæœ¬ç­–ç•¥ï¼š
  - æœªæŒ‡å®šç‰ˆæœ¬å·ï¼ˆå¦‚torch==2.3.0ï¼‰æ—¶ï¼Œé»˜è®¤å®‰è£…**æœ€æ–°ç¨³å®šç‰ˆ**ï¼ˆå½“å‰ä¸º PyTorch 2.3.0+cu121ï¼‰ã€‚
  - éœ€ä¸¥æ ¼ä¿æŒtorchã€torchvisionã€torchaudio ç‰ˆæœ¬åŒ¹é…ï¼ˆè¯¦è§ [PyTorch å®˜ç½‘å…¼å®¹è¡¨](https://pytorch.org/get-started/previous-versions/)ï¼‰ã€‚

------

### âš ï¸ **å®‰è£…å‰çš„ç¯å¢ƒæ£€æŸ¥**

#### 1. **ç¡¬ä»¶ä¸é©±åŠ¨è¦æ±‚**

| **é¡¹ç›®**        | **è¦æ±‚**                                    | **éªŒè¯å‘½ä»¤**              |
| :-------------- | :------------------------------------------ | :------------------------ |
| **NVIDIA æ˜¾å¡** | æ”¯æŒ CUDA æ¶æ„ï¼ˆå¦‚ RTX 20/30/40 ç³»åˆ—ï¼‰      | `nvidia-smi`              |
| **é©±åŠ¨ç‰ˆæœ¬**    | â‰¥ CUDA 12.1 è¦æ±‚çš„æœ€ä½é©±åŠ¨ï¼ˆæ¨è â‰¥ 525.60ï¼‰ | `nvidia-smi` é¦–è¡Œæ˜¾ç¤º     |
| **CUDA å·¥å…·åŒ…** | éœ€å®‰è£… **CUDA 12.1**ï¼ˆæˆ–æ›´é«˜å…¼å®¹ç‰ˆæœ¬ï¼‰      | `nvcc --version`          |
| **æ˜¾å­˜å®¹é‡**    | â‰¥ 4GBï¼ˆæ¨è â‰¥ 8GBï¼‰                         | `nvidia-smi` æŸ¥çœ‹æ˜¾å­˜å ç”¨ |

#### 2. **éªŒè¯é©±åŠ¨æ”¯æŒ**

```bash
nvidia-smi
```

- è¾“å‡ºå…³é”®ä¿¡æ¯ï¼š

  - `Driver Version`: é©±åŠ¨ç‰ˆæœ¬ï¼ˆéœ€ â‰¥ 525.60ï¼‰

  - CUDA Version: é©±åŠ¨æ”¯æŒçš„**æœ€é«˜ CUDA ç‰ˆæœ¬**ï¼ˆéœ€ â‰¥ 12.1ï¼‰

  - ç¤ºä¾‹è¾“å‡ºï¼š

    ```markdown
    CUDA Version: 12.4  # æ”¯æŒ CUDA 12.1 çš„å®‰è£…
    ```

> ğŸ“Œ æ³¨ï¼šè‹¥ `CUDA Version` æ˜¾ç¤ºä¸º 12.4ï¼Œä»å¯å®‰è£… `cu121` ç‰ˆæœ¬çš„ PyTorchï¼ˆå‘ä¸‹å…¼å®¹ï¼‰ã€‚

------

### ğŸ› ï¸ **å®Œæ•´å®‰è£…æ­¥éª¤**

#### âœ… 1. **æ¿€æ´»ç›®æ ‡ Conda ç¯å¢ƒ**

```bash
conda activate my_ai  # è¿›å…¥ä½ çš„éš”ç¦»ç¯å¢ƒ
```

#### âœ… 2. **æ‰§è¡Œ GPU ç‰ˆå®‰è£…å‘½ä»¤**

```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

- å®‰è£…è¿‡ç¨‹è¯´æ˜ï¼š

  - ä¸‹è½½å¤§å°çº¦ 2.2GBï¼ˆä¸»è¦æ¥è‡ªtorchåº“ï¼‰ã€‚

  - ç½‘ç»œä¸ä½³æ—¶å¯æ”¹ç”¨å›½å†…é•œåƒæºåŠ é€Ÿï¼š

    ```bash
    pip install torch torchvision torchaudio -i https://pypi.tuna.tsinghua.edu.cn/simple --index-url https://download.pytorch.org/whl/cu121
    ```

#### âœ… 3. **éªŒè¯å®‰è£…ç»“æœ**

åœ¨ Python ä¸­è¿è¡Œä»¥ä¸‹ä»£ç ï¼š

```python
import torch
print(torch.__version__)           # åº”è¾“å‡ºå¦‚ 2.3.0+cu121
print(torch.cuda.is_available())  # åº”è¾“å‡º True
print(torch.cuda.get_device_name(0))  # æ˜¾ç¤ºæ˜¾å¡å‹å·ï¼ˆå¦‚ RTX 3080ï¼‰
```

------

### âš ï¸ **å¸¸è§é—®é¢˜ä¸è§£å†³**

#### â“ **`torch.cuda.is_available()` è¿”å› False**

| **åŸå› **              | **è§£å†³æ–¹æ¡ˆ**                                                 |
| :-------------------- | :----------------------------------------------------------- |
| **é©±åŠ¨ä¸åŒ¹é…**        | æ›´æ–° NVIDIA é©±åŠ¨è‡³æœ€æ–°ç‰ˆï¼š[å®˜ç½‘ä¸‹è½½](https://www.nvidia.com/en-us/drivers/) |
| **CUDA å·¥å…·åŒ…æœªå®‰è£…** | å®‰è£… CUDA 12.1ï¼š[å®˜æ–¹ä¸‹è½½é¡µ](https://developer.nvidia.com/cuda-12-1-0-download-archive) |
| **ç¯å¢ƒå˜é‡æœªé…ç½®**    | æ·»åŠ  CUDA è·¯å¾„è‡³ç³»ç»Ÿå˜é‡ï¼š <br />Windows: C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.1\bin |
| **PyTorch ç‰ˆæœ¬é”™è¯¯**  | å¸è½½åé‡è£…ï¼š <br />`pip uninstall torch torchvision torchaudio` â†’ é‡æ–°æ‰§è¡Œ GPU å®‰è£…å‘½ä»¤ |

#### â“ **å®‰è£…å†²çªæˆ–ç‰ˆæœ¬ä¸åŒ¹é…**

- å¼ºåˆ¶å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼ˆä»¥ PyTorch 2.3.0 ä¸ºä¾‹ï¼‰ï¼š

  ```bash
  pip install torch==2.3.0 torchvision==0.18.0 torchaudio==2.3.0 --index-url https://download.pytorch.org/whl/cu121
  ```

- æ¸…ç†ç¯å¢ƒé‡å»ºï¼ˆç»ˆææ–¹æ¡ˆï¼‰ï¼š

  ```bash
  conda create -n torch_gpu python=3.10  # æ–°å»ºç¯å¢ƒ
  conda activate torch_gpu
  pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
  ```

------

### ğŸ’¡ **é«˜æ•ˆä½¿ç”¨å»ºè®®**

1. ç‰ˆæœ¬å…¼å®¹æ€§æŸ¥è¯¢

   - è®¿é—®[PyTorch å†å²ç‰ˆæœ¬é¡µé¢](https://pytorch.org/get-started/previous-versions/)æŸ¥çœ‹torch/torchvisionç»„åˆè¡¨ã€‚
   - ä¾‹å¦‚ PyTorch 2.3.0 éœ€åŒ¹é… `torchvision 0.18.0`ã€‚

2. æ··åˆç²¾åº¦è®­ç»ƒåŠ é€Ÿ

   ```python
   from torch.cuda.amp import autocast
   with autocast():
       outputs = model(inputs)  # è‡ªåŠ¨ä½¿ç”¨ FP16 åŠ é€Ÿè®¡ç®—
   ```

3. å¤š GPU åˆ†å¸ƒå¼è®­ç»ƒ

   ```python
   torch.distributed.init_process_group(backend="nccl")
   model = torch.nn.parallel.DistributedDataParallel(model)
   ```

#### **æ··åˆç²¾åº¦è®­ç»ƒå®ç°**ï¼š

1. **å¯ç”¨ Autocast ä¸Šä¸‹æ–‡**

   ```python
   from torch.cuda.amp import autocast, GradScaler
   scaler = GradScaler()  # æ¢¯åº¦ç¼©æ”¾ï¼Œé˜²æ­¢ FP16 ä¸‹æº¢å‡º
   for data, target in dataloader:
       optimizer.zero_grad()
       with autocast():   # è‡ªåŠ¨è½¬æ¢è®¡ç®—ä¸º FP16
           output = model(data)
           loss = criterion(output, target)
       scaler.scale(loss).backward()  # ç¼©æ”¾æ¢¯åº¦
       scaler.step(optimizer)         # æ›´æ–°å‚æ•°
       scaler.update()                # è°ƒæ•´ç¼©æ”¾å› å­
   ```

   - ä¼˜åŠ¿ï¼šæ˜¾å­˜å ç”¨å‡å°‘ 50%ï¼Œè®­ç»ƒé€Ÿåº¦æå‡ 30%+ï¼ˆå°¤å…¶é€‚åˆ Tensor Core GPU å¦‚ V100/A100ï¼‰ã€‚

2. **åŒæ­¥ Batch Normalizationï¼ˆSyncBNï¼‰**

   - ä½œç”¨ï¼šå¤š GPU é—´åŒæ­¥ BN å±‚ç»Ÿè®¡é‡ï¼Œæå‡å¤§ batch è®­ç»ƒç¨³å®šæ€§ã€‚

   - å¯ç”¨æ–¹å¼ï¼š 

     ```python
     model = torch.nn.SyncBatchNorm.convert_sync_batchnorm(model)
     ```

#### **å¤š GPU åˆ†å¸ƒå¼è®­ç»ƒï¼ˆDDPï¼‰**ï¼š

| **æ­¥éª¤**           | **å…³é”®ä»£ç /å‘½ä»¤**                                            | **ä½œç”¨**                    |
| :----------------- | :----------------------------------------------------------- | :-------------------------- |
| **åˆå§‹åŒ–è¿›ç¨‹ç»„**   | `dist.init_process_group(backend='nccl', init_method='env://')` | å»ºç«‹ GPU é—´é€šä¿¡åè®®ï¼ˆNCCLï¼‰ |
| **å°è£…æ¨¡å‹ä¸º DDP** | `model = DDP(model, device_ids=[rank])`                      | è‡ªåŠ¨å¤„ç†æ¢¯åº¦åŒæ­¥            |
| **æ•°æ®åˆ†ç‰‡**       | `sampler = DistributedSampler(dataset, num_replicas=world_size, rank=rank)` | é¿å…æ•°æ®é‡å¤                |
| **å¯åŠ¨è®­ç»ƒ**       | `torchrun --nproc_per_node=4 --nnodes=2 --master_addr=192.168.1.1 train.py` | å¤šæœºå¤šå¡å¯åŠ¨å‘½ä»¤            |

#### **æ€§èƒ½ä¼˜åŒ–æŠ€å·§**ï¼š

- æ¢¯åº¦ç´¯ç§¯ï¼šå‡å°‘é€šä¿¡é¢‘ç‡

  ```python
  for i, data in enumerate(dataloader):
      loss.backward()
      if (i+1) % 4 == 0:  # æ¯ 4 ä¸ª batch åŒæ­¥ä¸€æ¬¡æ¢¯åº¦
          optimizer.step()
          optimizer.zero_grad()
  ```

- é€šä¿¡åç«¯é€‰æ‹©ï¼š

  - GPU é›†ç¾¤ â†’backend='nccl'ï¼ˆNVIDIA ä¼˜åŒ–ï¼‰
  - CPU/è·¨å¹³å° â†’backend='gloo'ã€‚

------

### ğŸ’ **æ€»ç»“ï¼šé«˜æ•ˆåˆ†å¸ƒå¼è®­ç»ƒå·¥ä½œæµ**

1. ç‰ˆæœ¬ç®¡ç†ï¼šä¸¥æ ¼åŒ¹é…torch/torchvision/torchaudio \+ CUDA ç‰ˆæœ¬ã€‚
2. æ··åˆç²¾åº¦ï¼šautocast + GradScaler + SyncBNä¸‰é‡åŠ é€Ÿã€‚
3. åˆ†å¸ƒå¼æ‰©å±•ï¼š
   - å•æœºå¤šå¡ â†’ torchrun --nproc_per_node=4 train.py
   - å¤šæœºå¤šå¡ â†’ æŒ‡å®š --nnodes å’Œ --master_addrã€‚
4. é€šä¿¡ä¼˜åŒ–ï¼šæ¢¯åº¦ç´¯ç§¯ + NCCL åç«¯ + é¿å… find_unused_parameters=Trueã€‚

### ğŸš€**è¿ç§»åˆ° VS Code æ“ä½œæŒ‡å—**

#### âœ… **æ­¥éª¤1ï¼šå®‰è£… VS Code å¹¶é…ç½® Python æ‰©å±•**

1. ä¸‹è½½å®‰è£…ï¼šVS Code å®˜ç½‘
2. æ‰“å¼€åå®‰è£…æ‰©å±•ï¼š
   - **Python** (Microsoftå®˜æ–¹)
   - **Jupyter** (Microsoftå®˜æ–¹)
     https://i.imgur.com/2xVd2Qp.png

------

#### âœ… **æ­¥éª¤2ï¼šè¿æ¥ Conda ç¯å¢ƒåˆ° VS Code**

1. æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹ï¼š

   ```bash
   # åœ¨ VS Code ä¸­æŒ‰ Ctrl+K Ctrl+O
   é€‰æ‹© D:\AI  # ä½ ä¹‹å‰å¯åŠ¨Jupyterçš„ç›®å½•
   ```

2. æ¿€æ´» `my_ai` ç¯å¢ƒï¼š

   ```bash
   # æŒ‰ Ctrl+Shift+P æ‰“å¼€å‘½ä»¤é¢æ¿ â†’ è¾“å…¥ï¼š
   Python: Select Interpreter
   ```

   - é€‰æ‹©è·¯å¾„ï¼š
     `F:\ChuangYe\Anaconda3\envs\my_ai\python.exe`
     https://i.imgur.com/8fLmUO1.png

#### âœ… **æ­¥éª¤3ï¼šæ–°å»ºå¹¶è¿è¡Œ Jupyter Notebook**

1. **åˆ›å»ºæ–° Notebook**ï¼š

   ```bash
   æŒ‰ Ctrl+Shift+P â†’ è¾“å…¥ "Jupyter: Create New Blank Notebook"
   ```

2. **éªŒè¯ç¯å¢ƒ**ï¼š
   åœ¨ç¬¬ä¸€ä¸ªå•å…ƒæ ¼è¾“å…¥ï¼š

   ```python
   # %% [markdown]  ï¼ˆè¿™æ˜¯Jupyterå•å…ƒæ ¼æ ‡è®°ï¼‰
   # éªŒè¯ç¯å¢ƒæ˜¯å¦é…ç½®æ­£ç¡®
   
   # %% [code]
   import sys
   print("Pythonè·¯å¾„:", sys.executable)  # åº”æ˜¾ç¤ºmy_aiç¯å¢ƒçš„python
   import torch
   print("GPUå¯ç”¨:", torch.cuda.is_available())
   ```

3. **è¿è¡Œæ£€æŸ¥**ï¼š

   - ç‚¹å‡»å•å…ƒæ ¼å·¦ä¾§çš„ â–¶ï¸ å›¾æ ‡
   - æˆ–æŒ‰ `Shift+Enter`
     https://i.imgur.com/rG7JXq0.gif

#### âœ… **æ­¥éª¤4ï¼šè®¾ç½®æ°¸ä¹…è·¯å¾„ä¼˜åŒ–ï¼ˆé¿å‘å¿…çœ‹ï¼‰**

â– **é—®é¢˜ï¼šVS Code æ‰¾ä¸åˆ° Conda ç¯å¢ƒï¼Ÿ**
åœ¨ç”¨æˆ·è®¾ç½®ä¸­æ·»åŠ  Conda è·¯å¾„ï¼š

1. æŒ‰ `Ctrl+,` æ‰“å¼€è®¾ç½® â†’ å³ä¸Šè§’æ‰“å¼€ `settings.json`
2. æ·»åŠ é…ç½®ï¼š

```json
{
  "python.condaPath": "F:\\ChuangYe\\Anaconda3\\Scripts\\conda.exe",
  "python.defaultInterpreterPath": "F:\\ChuangYe\\Anaconda3\\envs\\my_ai\\python.exe"
}

```

****

â– **é—®é¢˜ï¼š è·¯å¾„ä¸­æ–‡å­—ç¬¦é—®é¢˜ç»ˆææ–¹æ¡ˆ?**

1. åœ¨ `settings.json` æ·»åŠ ç¼–ç è®¾ç½®ï¼š

   ```json
   "files.autoGuessEncoding": true,
   "files.encoding": "utf8"
   ```

### ğŸ“Š **ç¬¬äºŒæ­¥ï¼šè¿è¡Œç¬¬ä¸€ä¸ªAIæ¨¡å‹ï¼ˆ30åˆ†é’Ÿï¼‰**

**ç›®æ ‡ï¼šè®­ç»ƒMNISTæ‰‹å†™æ•°å­—è¯†åˆ«æ¨¡å‹**

1. æ–°å»ºJupyter Notebook

   ```bash
   pip install jupyter
   jupyter notebook  # æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€
   ```

2. å¤åˆ¶ä»£ç æ‰§è¡Œ

   ```python
   import torch
   import torch.nn as nn
   import torch.optim as optim
   from torchvision import datasets, transforms
   
   # 1. åŠ è½½æ•°æ®ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰
   transform = transforms.Compose([transforms.ToTensor()])
   train_data = datasets.MNIST('./data', train=True, download=True, transform=transform)
   train_loader = torch.utils.data.DataLoader(train_data, batch_size=64, shuffle=True)
   
   # 2. å®šä¹‰ç¥ç»ç½‘ç»œï¼ˆ3å±‚å…¨è¿æ¥ï¼‰
   class Net(nn.Module):
       def __init__(self):
           super(Net, self).__init__()
           self.fc1 = nn.Linear(784, 512)  # 28x28=784åƒç´ è¾“å…¥
           self.fc2 = nn.Linear(512, 256)
           self.fc3 = nn.Linear(256, 10)   # 10ä¸ªæ•°å­—åˆ†ç±»
       
       def forward(self, x):
           x = x.view(-1, 784)  # å±•å¹³å›¾ç‰‡
           x = torch.relu(self.fc1(x))
           x = torch.relu(self.fc2(x))
           return torch.log_softmax(self.fc3(x), dim=1)
   
   # 3. è®­ç»ƒæ¨¡å‹
   device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
   model = Net().to(device)
   optimizer = optim.Adam(model.parameters(), lr=0.001)
   
   for epoch in range(3):  # ä»…è®­ç»ƒ3è½®
       for batch_idx, (data, target) in enumerate(train_loader):
           data, target = data.to(device), target.to(device)
           optimizer.zero_grad()
           output = model(data)
           loss = nn.functional.nll_loss(output, target)
           loss.backward()
           optimizer.step()
           if batch_idx % 100 == 0:
               print(f'Epoch: {epoch} Loss: {loss.item():.4f}')
   
   torch.save(model.state_dict(), "first_ai_model.pth")
   ```

3. éªŒè¯æ•ˆæœ

   - è§‚å¯Ÿè¾“å‡ºï¼šæ¯100ä¸ªbatchæ‰“å°æŸå¤±å€¼ï¼ˆåº”æŒç»­ä¸‹é™ï¼‰
   - æœ€ç»ˆç²¾åº¦ï¼šå®Œæˆè®­ç»ƒåå¯è¾¾**92%+**ï¼ˆå¯åœ¨æµ‹è¯•é›†éªŒè¯ï¼‰

------

### ğŸŒ **ç¬¬ä¸‰æ­¥ï¼šç»“æœå¯è§†åŒ–ï¼ˆ15åˆ†é’Ÿï¼‰**

1. åŠ è½½æµ‹è¯•æ•°æ®

   ```python
   test_data = datasets.MNIST('./data', train=False, transform=transform)
   test_loader = torch.utils.data.DataLoader(test_data, batch_size=10)
   ```

2. éšæœºæ ·æœ¬é¢„æµ‹

   ```python
   import matplotlib.pyplot as plt
   %matplotlib inline
   
   model.load_state_dict(torch.load("first_ai_model.pth"))
   images, labels = next(iter(test_loader))
   outputs = model(images.to(device))
   preds = outputs.argmax(dim=1).cpu().numpy()
   
   # ç»˜åˆ¶é¢„æµ‹ç»“æœ
   plt.figure(figsize=(10,5))
   for i in range(10):
       plt.subplot(2,5,i+1)
       plt.imshow(images[i].squeeze(), cmap='gray')
       title_color = 'g' if preds[i]==labels[i] else 'r'
       plt.title(f"Pred: {preds[i]}", color=title_color)
       plt.axis('off')
   plt.show()
   ```

   æˆåŠŸæ ‡å¿—ï¼šå‡ºç°å«ç»¿è‰²é¢„æµ‹æ ‡ç­¾çš„æ•°å­—å›¾ç‰‡ï¼ˆçº¢è‰²ä¸ºé”™è¯¯ï¼‰